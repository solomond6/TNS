<div class="m-grid__item m-grid__item--fluid m-wrapper">
    <!-- BEGIN: Subheader -->
    <div class="m-subheader ">
        <div class="d-flex align-items-center">
            <div class="mr-auto">
                <h3 class="m-subheader__title ">
                    Email Campaign
                </h3>
            </div>
            <div>
                <!--<span class="m-subheader__daterange" id="m_dashboard_daterangepicker">
                    <span class="m-subheader__daterange-label">
                        <span class="m-subheader__daterange-title">Today:</span>
                        <span class="m-subheader__daterange-date m--font-brand">Feb 15</span>
                    </span>
                    <a href="#" class="btn btn-sm btn-brand m-btn m-btn--icon m-btn--icon-only m-btn--custom m-btn--pill">
                        <i class="la la-angle-down"></i>
                    </a>
                </span>-->
            </div>
        </div>
    </div>
    <div class="m-content">
        <div class="m-portlet">
            <div class="m-portlet__body m-portlet__body--no-padding">
                <div class="m-wizard m-wizard--3 m-wizard--success" id="m_wizard">
                    <div class="m-portlet__padding-x">
                    </div>
                    <div class="row m-row--no-padding">
                        <div class="col-xl-3 col-lg-12">
                            <div class="m-wizard__head">
                                <div class="m-wizard__progress">
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                                <div class="m-wizard__nav">
                                    <div class="m-wizard__steps">
                                        <div class="m-wizard__step m-wizard__step--current" data-wizard-target="#m_wizard_form_step_1">
                                            <div class="m-wizard__step-info">
                                                <a href="#" class="m-wizard__step-number">
                                                    <span>
                                                        <span>
                                                            1
                                                        </span>
                                                    </span>
                                                </a>
                                                <div class="m-wizard__step-line">
                                                    <span></span>
                                                </div>
                                                <div class="m-wizard__step-label">
                                                    Select Category
                                                </div>
                                            </div>
                                        </div>
                                        <div class="m-wizard__step" data-wizard-target="#m_wizard_form_step_2">
                                            <div class="m-wizard__step-info">
                                                <a href="#" class="m-wizard__step-number">
                                                    <span>
                                                        <span>
                                                            2
                                                        </span>
                                                    </span>
                                                </a>
                                                <div class="m-wizard__step-line">
                                                    <span></span>
                                                </div>
                                                <div class="m-wizard__step-label">
                                                    Select A Template
                                                </div>
                                            </div>
                                        </div>
                                        <div class="m-wizard__step" data-wizard-target="#m_wizard_form_step_3">
                                            <div class="m-wizard__step-info">
                                                <a href="#" class="m-wizard__step-number">
                                                    <span>
                                                        <span>
                                                            3
                                                        </span>
                                                    </span>
                                                </a>
                                                <div class="m-wizard__step-line">
                                                    <span></span>
                                                </div>
                                                <div class="m-wizard__step-label">
                                                    Setup
                                                </div>
                                            </div>
                                        </div>
                                        <div class="m-wizard__step" data-wizard-target="#m_wizard_form_step_4">
                                            <div class="m-wizard__step-info">
                                                <a href="#" class="m-wizard__step-number">
                                                    <span>
                                                        <span>
                                                            4
                                                        </span>
                                                    </span>
                                                </a>
                                                <div class="m-wizard__step-line">
                                                    <span></span>
                                                </div>
                                                <div class="m-wizard__step-label">
                                                    Content
                                                </div>
                                            </div>
                                        </div>
                                        <div class="m-wizard__step" data-wizard-target="#m_wizard_form_step_5">
                                            <div class="m-wizard__step-info">
                                                <a href="#" class="m-wizard__step-number">
                                                    <span>
                                                        <span>
                                                            5
                                                        </span>
                                                    </span>
                                                </a>
                                                <div class="m-wizard__step-line">
                                                    <span></span>
                                                </div>
                                                <div class="m-wizard__step-label">
                                                    Schedule
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-9 col-lg-12">
                            <div class="m-wizard__form">
                                <form class="m-form m-form--label-align-left- m-form--state-" id="m_form" method="post" action="@Url.Action("Create", "Campaign")" enctype="multipart/form-data">
                                    <div class="m-portlet__body m-portlet__body--no-padding">
                                        @if (TempData["Msg"] != null)
                                        {
                                            <alert class="alert alert-success">@TempData["Msg"]</alert>
                                        }
                                        @if (TempData["Error"] != null)
                                        {
                                            <alert class="alert alert-danger">@TempData["Error"]</alert>
                                        }
                                        
                                        <div class="m-wizard__form-step m-wizard__form-step--current" id="m_wizard_form_step_1">
                                            <div class="m-form__section m-form__section--first">
                                                <div class="m-form__heading">
                                                    <h3 class="m-form__heading-title">
                                                        Select A Category
                                                    </h3>
                                                </div>
                                            </div>

                                            <div class="m-separator m-separator--dashed m-separator--lg"></div>
                                            <div class="c-templateSelection_item c-choiceCard c-choiceCard--thick m-radio-list" id="t-list2">
                                                <label class="m-radio m-radio--solid m-radio--success">
                                                    <input type="radio" name="campaignType" id="generic" value="Generic" class="input-radio"/> Generic Notification 
                                                    <span></span>
                                                </label>
                                                <label class="m-radio m-radio--solid m-radio--success">
                                                    <input type="radio" name="campaignType" id="birthday" value="Auto" class="input-radio" data-type="@ViewBag.Birthday" /> Birthday Notification
                                                    <span></span>
                                                </label>
                                                <label class="m-radio m-radio--solid m-radio--success">
                                                    <input type="radio" name="campaignType" id="ThreemonthsRedemption" value="Auto" class="input-radio" data-type="@ViewBag.ThreemonthsRedemption" /> Clients who redeemed without subscribing for 3 months
                                                    <span></span>
                                                </label>
                                                <label class="m-radio m-radio--solid m-radio--success">
                                                    <input type="radio" name="campaignType" id="NotificationChange" value="Auto" class="input-radio" data-type="@ViewBag.NotificationChange" /> Client Information Update
                                                    <span></span>
                                                </label>
                                                <label class="m-radio m-radio--solid m-radio--success">
                                                    <input type="radio" name="campaignType" id="AdditionalSubscription" value="Auto" class="input-radio" data-type="@ViewBag.AdditionalSubscription" /> Additional Subscription Notification
                                                    <span></span>
                                                </label>
                                                <label class="m-radio m-radio--solid m-radio--success">
                                                    <input type="radio" name="campaignType" id="WelcomePack" value="Auto" class="input-radio" data-type="@ViewBag.WelcomePack" /> Welcome Package
                                                    <span></span>
                                                </label>
                                                <label class="m-radio m-radio--solid m-radio--success">
                                                    <input type="radio" name="campaignType" id="WebAccess" value="Auto" class="input-radio" data-type="@ViewBag.WebAccess" /> Web Access Notification
                                                    <span></span>
                                                </label>
                                            </div>
                                            <div class="m-separator m-separator--dashed m-separator--lg"></div>
                                            <h4>Customer Journey celebration</h4>
                                            <div class="c-templateSelection_item c-choiceCard c-choiceCard--thick m-radio-list" id="t-list2">
                                                <label class="m-radio m-radio--solid m-radio--success">
                                                    <input type="radio" name="campaignType" id="30days" value="Auto" class="input-radio" data-type="@ViewBag.CustomerJourney" /> 30 Days
                                                    <span></span>
                                                </label>
                                                <label class="m-radio m-radio--solid m-radio--success">
                                                    <input type="radio" name="campaignType" id="60days" value="Auto" class="input-radio" data-type="@ViewBag.CustomerJourney"/> 60 Days
                                                    <span></span>
                                                </label>
                                                <label class="m-radio m-radio--solid m-radio--success">
                                                    <input type="radio" name="campaignType" id="90days" value="Auto" class="input-radio" data-type="@ViewBag.CustomerJourney"/> 90 Days
                                                    <span></span>
                                                </label>
                                                <label class="m-radio m-radio--solid m-radio--success">
                                                    <input type="radio" name="campaignType" id="365days" value="Auto" class="input-radio" data-type="@ViewBag.CustomerJourney"/> 1 year
                                                    <span></span>
                                                </label>
                                                
                                            </div>
                                        </div>
                                        
                                        <div class="m-wizard__form-step" id="m_wizard_form_step_2">
                                            <div class="m-form__section m-form__section--first">
                                                <div class="m-form__heading">
                                                    <h3 class="m-form__heading-title">
                                                        Select A Template
                                                    </h3>
                                                </div>
                                            </div>

                                            <div class="m-separator m-separator--dashed m-separator--lg"></div>
                                            <div class="c-templateSelection_item c-choiceCard c-choiceCard--thick" id="t-list">

                                            </div>
                                        </div>

                                        <div class="m-wizard__form-step" id="m_wizard_form_step_3">
                                            <div class="m-form__section m-form__section--first">
                                                <div class="m-form__heading">
                                                    <h3 class="m-form__heading-title">
                                                        Campaign Setup
                                                    </h3>
                                                </div>
                                            </div>
                                            
                                            <div class="m-separator m-separator--dashed m-separator--lg"></div>
                                            <div class="m-form__section wizard-form">
                                                <div class="form-group m-form__group row list-div">
                                                    <label class="col-xl-3 col-lg-3 col-form-label">
                                                        * List:
                                                    </label>
                                                    <div class="col-xl-9 col-lg-9">
                                                        <select name="ListID" class="form-control m-input" id="listID">
                                                            <option value="">
                                                                Select The Mail List
                                                            </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="form-group m-form__group row">
                                                    <label class="col-xl-3 col-lg-3 col-form-label">
                                                        * Campaign Name:
                                                    </label>
                                                    <div class="col-xl-9 col-lg-9">
                                                        <input type="text" name="CampaignName" class="form-control m-input" placeholder="">
                                                        <span class="m-form__help">
                                                            Enter The Campaign Name
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="form-group m-form__group row">
                                                    <label class="col-xl-3 col-lg-3 col-form-label">
                                                        Sender Name:
                                                    </label>
                                                    <div class="col-xl-9 col-lg-9">
                                                        <input type="text" name="SenderName" class="form-control m-input" placeholder="">
                                                        <span class="m-form__help">
                                                            Provide The Name of The Sender E.g Stanbic IBTC
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="form-group m-form__group row">
                                                    <label class="col-xl-3 col-lg-3 col-form-label">
                                                        Sender Email:
                                                    </label>
                                                    <div class="col-xl-9 col-lg-9">
                                                        <div class="input-group">
                                                            <input type="text" name="SenderEmail" id="senderEmail" class="form-control m-input" placeholder="">
                                                        </div>
                                                        <span class="m-form__help">
                                                            Provide The Email Address of The Sender E.g abc@xyz.com
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="form-group m-form__group row recipient-div">
                                                    <label class="col-xl-3 col-lg-3 col-form-label">
                                                        Recipient Email:
                                                    </label>
                                                    <div class="col-xl-9 col-lg-9">
                                                        <div class="input-group">
                                                            <select name="Recipient" class="form-control m-input btn-success" id="listID1" data-style="btn-primary">
                                                                <option value="">
                                                                    Select Tag
                                                                </option>
                                                            </select>
                                                        </div>
                                                        <span class="m-form__help">
                                                            Provide The Email Address of The Recipient E.g abc@xyz.com
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="form-group m-form__group row cc-div">
                                                    <label class="col-xl-3 col-lg-3 col-form-label">
                                                        CC:
                                                    </label>
                                                    <div class="col-xl-9 col-lg-9">
                                                        <div class="input-group">
                                                            <select name="CC" class="form-control m-input btn-success" id="listID2" data-style="btn-primary">
                                                                <option value="">
                                                                    Select Tag
                                                                </option>
                                                            </select>
                                                        </div>
                                                        <span class="m-form__help">
                                                            Provide The CC Email Address of The Sender E.g abc@xyz.com
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="form-group m-form__group row bcc-div">
                                                    <label class="col-xl-3 col-lg-3 col-form-label">
                                                        BCC:
                                                    </label>
                                                    <div class="col-xl-9 col-lg-9">
                                                        <div class="input-group">
                                                            <select name="Bcc" class="form-control m-input btn-success" id="listID3">
                                                                <option value="">
                                                                    Select Tag
                                                                </option>
                                                            </select>
                                                        </div>
                                                        <span class="m-form__help">
                                                            Provide The BCC Email Address of The Sender E.g abc@xyz.com
                                                        </span>
                                                    </div>
                                                </div>
                                                
                                            </div>
                                        </div>
                                        <div class="m-wizard__form-step" id="m_wizard_form_step_4">
                                            <div class="m-form__section m-form__section--first">
                                                <div class="m-form__heading">
                                                    <h3 class="m-form__heading-title">
                                                        Campaign Content
                                                    </h3>
                                                </div>
                                                <div class="form-group m-form__group row">
                                                    <div class="col-lg-12">
                                                        <label class="form-control-label">
                                                            * Email Subject:
                                                        </label>
                                                        <div class="input-group">
                                                            <input type="text" name="EmailTitle" class="form-control m-input" id="EmailTitle" data-value="" placeholder="">
                                                            <div class="input-group-append">
                                                                <select class="form-control m-input btn-success" id="listID4" data-style="btn-primary">
                                                                    <option value="">
                                                                        Select Tag
                                                                    </option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <span class="m-form__help">
                                                            Please Enter The Email Subject
                                                        </span>
                                                    </div>
                                                </div>
                                                <hr/>
                                                <div class="form-group m-form__group row">
                                                    <div class="col-lg-12">
                                                        <label class="form-control-label">
                                                            Attachment:
                                                        </label>
                                                        <div class="input-group">
                                                            <input type="file" name="Attachment" class="form-control m-input" id="Attachment" placeholder="" onchange="readURL(this);">
                                                        </div>
                                                        <span class="m-form__help">
                                                            Please attach a document if needed.
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="form-group m-form__group row">
                                                    <div class="col-lg-12 m-form__group-sub">
                                                        <label class="form-control-label">
                                                            * Content:
                                                        </label>
                                                        <textarea name="ParamiterizedTemplate" id="summernote" class="summernote" rows="0"></textarea>
                                                        <span class="m-form__help">
                                                            Body of the mail
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="m-wizard__form-step" id="m_wizard_form_step_5">
                                            <div class="m-form__section m-form__section--first" id="hideSchedule">
                                                <div class="m-form__heading">
                                                    <h3 class="m-form__heading-title">
                                                        Schedule Campaign
                                                    </h3>
                                                </div>
                                                <div class="form-group m-form__group row">
                                                    <div class="col-lg-12">
                                                        <label class="form-control-label">
                                                            * Start Date:
                                                        </label>
                                                        <div class="input-group date startdate" data-link-field="dtp_input1">
                                                            <input name="startdate" class="form-control" size="16" type="text" value="" readonly>
                                                            <span class="input-group-append input-group-addon"><span class="input-group-text glyphicon glyphicon-remove"><i class="fa fa-remove"></i></span></span>
                                                            <span class="input-group-append input-group-addon"><span class="input-group-text glyphicon glyphicon-th"><i class="fa fa-calendar"></i></span></span>
                                                        </div>
                                                        <input type="hidden" id="dtp_input1" value="" /><br />

                                                    </div>
                                                </div>
                                                <div class="form-group m-form__group row">
                                                    <div class="col-lg-12">
                                                        <label class="form-control-label">
                                                            * End Date:
                                                        </label>
                                                        <div class="input-group date enddate" data-link-field="dtp_input1">
                                                            <input name="enddate" class="form-control" size="16" type="text" value="" readonly>
                                                            <span class="input-group-append input-group-addon"><span class="input-group-text glyphicon glyphicon-remove"><i class="fa fa-remove"></i></span></span>
                                                            <span class="input-group-append input-group-addon"><span class="input-group-text glyphicon glyphicon-th"><i class="fa fa-calendar"></i></span></span>
                                                        </div>
                                                        <input type="hidden" id="dtp_input1" value="" /><br />
                                                    </div>
                                                </div>
                                                <div class="form-group m-form__group row">
                                                    <div class="col-lg-12">
                                                        <label class="col-form-label">
                                                            * Cycle:
                                                        </label>
                                                        <select name="Cycle" class="form-control m-input" id="cycle">
                                                            <option value="">Select The Cycle</option>
                                                            <option value="Once">Once</option>
                                                            <option value="Daily">Daily</option>
                                                            <option value="Weekly">Weekly</option>
                                                            <option value="Monthly">Monthly</option>
                                                            <option value="Quarterly">Quarterly</option>
                                                            <option value="Yearly">Yearly</option>
                                                        </select>
                                                        <input type="hidden" id="dtp_input4" name="deliveryType" value="Email" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="m-separator m-separator--dashed m-separator--lg"></div>
                                            <div class="m-form__section m-form__section--first">
                                                <h2 style="color:red;">Note:</h2>
                                                <h4>Ensure you review all the entries before you schedule this campaign.</h4>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="m-portlet__foot m-portlet__foot--fit m--margin-top-40">
                                        <div class="m-form__actions">
                                            <div class="row">
                                                <div class="col-lg-6 m--align-left">
                                                    <a href="#" class="btn btn-secondary m-btn m-btn--custom m-btn--icon" data-wizard-action="prev">
                                                        <span>
                                                            <i class="la la-arrow-left"></i>
                                                            &nbsp;&nbsp;
                                                            <span>
                                                                Back
                                                            </span>
                                                        </span>
                                                    </a>
                                                </div>
                                                <div class="col-lg-6 m--align-right">
                                                    
                                                    <button class="btn btn-primary m-btn m-btn--custom m-btn--icon" type="submit" data-wizard-action="submit">
                                                        Schedule Campaign
                                                    </button>
                                                    
                                                    <a href="#" class="btn btn-success m-btn m-btn--custom m-btn--icon" data-wizard-action="next">
                                                        <span>
                                                            <span>
                                                                Continue
                                                            </span>
                                                            &nbsp;&nbsp;
                                                            <i class="la la-arrow-right"></i>
                                                        </span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="m_modal_6" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="exampleModalLongTitle">Test Campaign</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="col-form-label">* Test Email:</label>
                    <input type="text" name="testCampaign" class="form-control m-input" placeholder="" required>
                </div>
            </div>
            <div class="loading">Sending Test SMS</div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="sendTest">Send Test</button>
            </div>
        </div>
    </div>
</div>	

<div class="modal fade modal-fullscreen footer-to-bottom" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog animated" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="exampleModalLabel"></h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="contentPreview"></div>
        </div>
    </div>
</div>

@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/bootstrap")
<script src="~/Scripts/tinymce/jquery.tinymce.min.js"></script>
<script src="~/Scripts/tinymce/tinymce.min.js"></script>
<script>
    $('input[type=radio]').attr('checked',false);
    $("input[type=radio]:checked + label > img").css({ 'background' : '', 'border' : '' });
    $("input[type=radio]:checked + label > div").css({ 'background' : '', 'border' : '' });

    $(".loading").hide();
    $(document).on("click", "#sendTest", function(){
        $(this).attr("disable", true);

        $.ajax({
            type: "GET",
            url: "@Url.Action("TestCampaign", "Campaign")",
            contentType: "application/json; charset=utf-8",
            data: $("#m_form").serialize(),
            dataType: "json",
            beforeSend: function (){
                $(".loading").show();
            },
            success: function (data) {
                console.log();
            },
            complete: function(){
                $(".loading").hide();
            }
        });
    });

    $.ajax({
        type: "GET",
        url: "@Url.Action("GetAllTemplates", "Templates")",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        //data: {'templateid': templateId },
        success: function (data) {
            $.each(data, function (index, item) {
                requestData = item;
                jQuery.grep(item, function(template, i) {
                    $("#t-list").append('<input type="radio" name="template" id="'+template.ID+'" value="'+template.ID+'" class="input-hidden" /><label for="'+template.ID+'" id="label-radio"><div><a class="btn btn-primary" data-toggle="modal" data-id="'+template.ID+'" data-target="#exampleModal" id="preview">Preview</a><h5>'+template.Title+'</h5><h6>'+template.Datecreated+'</h6></div></label>');
                });
            });
        }
    });

    $(document).on('click', '#preview', function(){
        var templateId = $(this).data('id');
        $.ajax({
            type: "GET",
            url: "@Url.Action("GetTemplatePreview", "Templates")",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            data: {'templateid': templateId },
            success: function (data) {
                $.each(data, function (index, item) {
                    requestData = item;
                    jQuery.grep(item, function(template, i) {
                         $(".modal-title").html(template.Title)
                         $(".contentPreview").html(template.Contents)
                    });
                });
            }
        });
    });

    $(document).on('click', '.input-hidden', function(){
        var templateId = $("input[name='template']:checked").val();
        $('#summernote').val("");

        //$("#listID").empty().append($('<option>', { value: '', text: "Select A List" }));
        $("#listID1").empty().append($('<option>', { value: '', text: "Select Tag" }));
        $("#listID2").empty().append($('<option>', { value: '', text: "Select Tag" }));
        $("#listID3").empty().append($('<option>', { value: '', text: "Select Tag" }));
        $("#listID4").empty().append($('<option>', { value: '', text: "Select Tag" }));

        tinymce.remove('textarea');
        tinymce.remove();
        tinymce.remove('#summernote');

        /*$.ajax({
            type: "GET",
            url: "@Url.Action("GetAllLists", "Lists")",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                $.each(data, function (index, item) {
                    list = item;
                    jQuery.grep(item, function(list, i) {

                        if(list.Listtype == ""){
                            $('#listID').append($('<option>', {
                                value: list.ID,
                                text: list.Listname
                            }));
                        }
                    });
                });
            }
        });*/

        $.ajax({
            type: "GET",
            url: "@Url.Action("GetTemplatePreview", "Templates")",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            data: {'templateid': templateId },
            success: function (data) {
                $.each(data, function (index, item) {
                    requestData = item;
                    jQuery.grep(item, function(template, i) {
                        localStorage.setItem("contents", template.Contents);
                        $('#summernote').val(template.Contents);
                    });
                });
            }
        });
    });

    $(document).on('change', '.input-radio', function(){
        var categoryId = $("input[name='campaignType']:checked").val();
        var catType = $(this).data("type");
        tinymce.remove('textarea');
        tinymce.remove();
        tinymce.remove('#summernote');

        if(categoryId != "Generic"){

            $("#listID").empty().append($('<option>', { value: '', text: "Select Tag" }));
            $("#listID1").empty().append($('<option>', { value: '', text: "Select Tag" }));
            $("#listID2").empty().append($('<option>', { value: '', text: "Select Tag" }));
            $("#listID3").empty().append($('<option>', { value: '', text: "Select Tag" }));
            $("#listID4").empty().append($('<option>', { value: '', text: "Select Tag" }));
            $("#hideSchedule").hide();

            var array = [
                { text: 'First Name', value: '$$FirstName$$' },
                { text: 'Last Name', value: '$$LastName$$' },
                { text: 'Middle Name', value: '$$MiddleName$$' },
                { text: 'Date of Birth', value: '$$DOB$$' },
                { text: 'Email Address', value: '$$Email$$' },
                { text: 'Phone Number', value: '$$PhoneNum$$' },
                { text: 'Account Name', value: '$$AccountName$$' },
                { text: 'Fund Id', value: '$$FundId$$' },
                { text: 'Fund Name', value: '$$FundName$$' },
                { text: 'Investment Date', value: '$$InvestmentDate$$' },
                { text: 'Balance', value: '$$Balance$$' },
            ];

            $.ajax({
                type: "GET",
                url: "@Url.Action("GetAllLists", "Lists")",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    $.each(data, function (index, item) {
                        list = item;
                        jQuery.grep(item, function(list, i) {
                            if(list.Listtype == catType){
                                $('#listID').append($('<option>', {
                                    value: list.ID,
                                    text: list.Listname
                                }));
                            }
                        });
                    });
                }
            });

            var option = '';
            for(var i = 0; i < array.length; i++){
                option += '<option value="' + array[i].value + '">' + array[i].text + '</option>';
            }

            //$("#listID1").append(option);
            //$("#listID2").append(option);
            //$("#listID3").append(option);
            //$("#listID4").append(option);

        }else{

            $("#hideSchedule").show();
            tinymce.remove('textarea');
            tinymce.remove();
            tinymce.remove('#summernote');

            $.ajax({
                type: "GET",
                url: "@Url.Action("GetAllLists", "Lists")",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    $.each(data, function (index, item) {
                        list = item;
                        jQuery.grep(item, function(list, i) {
                            if(list.Listtype == ""){
                                $('#listID').append($('<option>', {
                                    value: list.ID,
                                    text: list.Listname
                                }));
                            }
                        });
                    });
                }
            });

            $("#listID").show();
            $("#listID1").show();
            $("#listID2").show();
            $("#listID3").show();
            $("#listID4").show();
            $("#bcc").show();
            $("#cc").show();
            $("#Recipient").show();

            $(".cc-div").show();
            $(".bcc-div").show();
            $(".recipient-div").show();
            $(".list-div").show();

            var WizardDemo = function () {
                var wizardEl = $('#m_wizard');
                var formEl = $('#m_form');
                var validator;
                var wizard;

                var initWizard = function () {
                    wizard = wizardEl.mWizard({
                        startStep: 1
                    });
                    wizard.on('beforeNext', function(wizard) {
                        if (validator.form() !== true) {
                            return false;
                        }
                    })
                    wizard.on('change', function(wizard) {
                        mApp.scrollTop();
                    });
                }

                var initValidation = function() {
                    validator = formEl.validate({
                        ignore: ":hidden",
                        rules: {
                            campaignType: {
                                required: true
                            },
                            CampaignName: {
                                required: true
                            },
                            SenderName: {
                                required: true
                            },
                            SenderEmail: {
                                required: true,
                                email: true
                            },
                            Recipient: {
                                required: true
                            },
                            ListID: {
                                required: true
                            },
                            EmailTitle: {
                                required: true
                            },
                            StartDate: {
                                required: true
                            },
                            ParamiterizedTemplate: {
                                required: true
                            },
                            startdate: {
                                required: true
                            },
                            enddate: {
                                required: true
                            },
                            Cycle: {
                                required: true
                            },
                        },
                        messages: {
                            'account_communication[]': {
                                required: 'You must select at least one communication option'
                            },
                            accept: {
                                required: "You must accept the Terms and Conditions agreement!"
                            }
                        },
                        invalidHandler: function(event, validator) {
                            mApp.scrollTop();

                            swal({
                                "title": "",
                                "text": "There are some errors in your form. Please correct them.",
                                "type": "error",
                                "confirmButtonClass": "btn btn-secondary m-btn m-btn--wide"
                            });
                        },
                    });
                }
                return {
                    // public functions
                    init: function() {
                        wizardEl = $('#m_wizard');
                        formEl = $('#m_form');

                        initWizard();
                        initValidation();
                    }
                };
            }();
        }
    });

    var d = new Date();
    var month = d.getMonth()+1;
    var day = d.getDate();
    var output = d.getFullYear() + '-' +
        ((''+month).length<2 ? '0' : '') + month + '-' +
        ((''+day).length<2 ? '0' : '') + day;

    $('.startdate').datetimepicker({
        pickerPosition: "bottom left",
        autoclose: 1,
		todayHighlight: 1,
        use24hours: true,
        startDate: output,
        format: 'yyyy-MM-dd hh:ii:ss',
    }).on('changeDate', function(ev){
        $('.enddate').datetimepicker('setStartDate', ev.date);
    });

    $('.enddate').datetimepicker({
		pickerPosition: "bottom left",
        autoclose: 1,
		todayHighlight: 1,
        use24hours: true,
        format: 'yyyy-MM-dd hh:ii:ss'
    });

    var WizardDemo = function () {
        var wizardEl = $('#m_wizard');
        var formEl = $('#m_form');
        var validator;
        var wizard;

        var initWizard = function () {
            wizard = wizardEl.mWizard({
                startStep: 1
            });

            wizard.on('beforeNext', function(wizard) {
                if (validator.form() !== true) {
                    return false;
                }
            })

            wizard.on('change', function(wizard) {
                mApp.scrollTop();
            });
        }

        var initValidation = function() {
            validator = formEl.validate({
                ignore: ":hidden",
                rules: {
                    campaignType: {
                        required: true
                    },
                    CampaignName: {
                        required: true
                    },
                    SenderName: {
                        required: true
                    },
                    SenderEmail: {
                        required: true,
                        email: true
                    },
                    Recipient: {
                        required: true
                    },
                    ListID: {
                        required: true
                    },
                    EmailTitle: {
                        required: true
                    },
                    StartDate: {
                        required: true
                    },
                    ParamiterizedTemplate: {
                        required: true
                    },
                    startdate: {
                        required: true
                    },
                    enddate: {
                        required: true
                    },
                    Cycle: {
                        required: true
                    },
                },

                messages: {
                    'account_communication[]': {
                        required: 'You must select at least one communication option'
                    },
                    accept: {
                        required: "You must accept the Terms and Conditions agreement!"
                    }
                },

                invalidHandler: function(event, validator) {
                    mApp.scrollTop();

                    swal({
                        "title": "",
                        "text": "There are some errors in your form. Please correct them.",
                        "type": "error",
                        "confirmButtonClass": "btn btn-secondary m-btn m-btn--wide"
                    });
                },
            });
        }

        return {
            // public functions
            init: function() {
                wizardEl = $('#m_wizard');
                formEl = $('#m_form');

                initWizard();
                initValidation();
            }
        };
    }();

    jQuery(document).ready(function() {
        WizardDemo.init();
    });

    $(document).on('change', '#listID', function(){

        $("#listID1").empty().append($('<option>', { value: '', text: "Select Tag" }));
        $("#listID2").empty().append($('<option>', { value: '', text: "Select Tag" }));
        $("#listID3").empty().append($('<option>', { value: '', text: "Select Tag" }));
        $("#listID4").empty().append($('<option>', { value: '', text: "Select Tag" }));

        tinymce.remove('textarea');
        tinymce.remove();
        tinymce.remove('#summernote');

        $("#bcc").val("");
        $("#cc").val("");
        $("#EmailTitle").val("");
        $("#Recipient").val("");

        var listId = $(this).val();
        var headers = [];

        $.ajax({
            type: "GET",
            url: "@Url.Action("GetListHeaders", "Lists")",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            data: {"id": listId},
            success: function (data) {
                $.each(data, function (index, item) {
                    headers.push(item[0]);
                    if(item[0].H1 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H1$$',
                            text: item[0].H1
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H1$$',
                            text: item[0].H1
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H1$$',
                            text: item[0].H1
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H1$$',
                            text: item[0].H1
                        }));
                    }
                    if(item[0].H2 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H2$$',
                            text: item[0].H2
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H2$$',
                            text: item[0].H2
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H3$$',
                            text: item[0].H2
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H2$$',
                            text: item[0].H2
                        }));
                    }
                    if(item[0].H3 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H3$$',
                            text: item[0].H3
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H3$$',
                            text: item[0].H3
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H3$$',
                            text: item[0].H3
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H3$$',
                            text: item[0].H3
                        }));
                    }
                    if(item[0].H4 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H4$$',
                            text: item[0].H4
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H4$$',
                            text: item[0].H4
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H4$$',
                            text: item[0].H4
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H4$$',
                            text: item[0].H4
                        }));
                    }
                    if(item[0].H5 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H5$$',
                            text: item[0].H5
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H5$$',
                            text: item[0].H5
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H5$$',
                            text: item[0].H5
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H5$$',
                            text: item[0].H5
                        }));
                    }
                    if(item[0].H6 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H6$$',
                            text: item[0].H6
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H6$$',
                            text: item[0].H6
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H6$$',
                            text: item[0].H6
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H6$$',
                            text: item[0].H6
                        }));
                    }
                    if(item[0].H7 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H7$$',
                            text: item[0].H7
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H7$$',
                            text: item[0].H7
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H7$$',
                            text: item[0].H7
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H8$$',
                            text: item[0].H7
                        }));
                    }
                    if(item[0].H8 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H8$$',
                            text: item[0].H8
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H8$$',
                            text: item[0].H8
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H8$$',
                            text: item[0].H8
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H9$$',
                            text: item[0].H8
                        }));
                    }
                    if(item[0].H9 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H9$$',
                            text: item[0].H9
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H9$$',
                            text: item[0].H9
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H9$$',
                            text: item[0].H9
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H9$$',
                            text: item[0].H9
                        }));
                    }
                    if(item[0].H10 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H10$$',
                            text: item[0].H10
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H10$$',
                            text: item[0].H10
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H10$$',
                            text: item[0].H10
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H10$$',
                            text: item[0].H10
                        }));
                    }
                    if(item[0].H11 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H11$$',
                            text: item[0].H11
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H11$$',
                            text: item[0].H11
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H11$$',
                            text: item[0].H11
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H11$$',
                            text: item[0].H11
                        }));
                    }
                    if(item[0].H12 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H12$$',
                            text: item[0].H12
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H12$$',
                            text: item[0].H12
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H12$$',
                            text: item[0].H12
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H12$$',
                            text: item[0].H12
                        }));
                    }
                    if(item[0].H13 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H13$$',
                            text: item[0].H13
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H1$$',
                            text: item[0].H13
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H1$$',
                            text: item[0].H13
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H13$$',
                            text: item[0].H13
                        }));
                    }
                    if(item[0].H14 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H14$$',
                            text: item[0].H14
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H14$$',
                            text: item[0].H14
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H14$$',
                            text: item[0].H14
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H14$$',
                            text: item[0].H14
                        }));
                    }
                    if(item[0].H15 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H15$$',
                            text: item[0].H15
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H15$$',
                            text: item[0].H15
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H15$$',
                            text: item[0].H15
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H15$$',
                            text: item[0].H15
                        }));
                    }
                    if(item[0].H16 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H16$$',
                            text: item[0].H16
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H16$$',
                            text: item[0].H16
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H16$$',
                            text: item[0].H16
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H16$$',
                            text: item[0].H16
                        }));
                    }
                    if(item[0].H17 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H17$$',
                            text: item[0].H17
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H17$$',
                            text: item[0].H17
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H17$$',
                            text: item[0].H17
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H17$$',
                            text: item[0].H17
                        }));
                    }
                    if(item[0].H18 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H18$$',
                            text: item[0].H18
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H18$$',
                            text: item[0].H18
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H18$$',
                            text: item[0].H18
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H18$$',
                            text: item[0].H18
                        }));
                    }
                    if(item[0].H19 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H19$$',
                            text: item[0].H19
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H19$$',
                            text: item[0].H19
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H19$$',
                            text: item[0].H19
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H19$$',
                            text: item[0].H19
                        }));
                    }
                    if(item[0].H20 != ""){
                        $('#listID1').append($('<option>', {
                            value: '$$H20$$',
                            text: item[0].H20
                        }));
                        $('#listID2').append($('<option>', {
                            value: '$$H20$$',
                            text: item[0].H20
                        }));
                        $('#listID3').append($('<option>', {
                            value: '$$H20$$',
                            text: item[0].H20
                        }));
                        $('#listID4').append($('<option>', {
                            value: '$$H20$$',
                            text: item[0].H20
                        }));
                    }
                });
            }
        });

        setTimeout(function() {
                if(headers[0].H20 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' },
                              { text: headers[0].H7, value: '&nbsp;<strong>$$H7$$</strong>' },
                              { text: headers[0].H8, value: '&nbsp;<strong>$$H8$$</strong>' },
                              { text: headers[0].H9, value: '&nbsp;<strong>$$H9$$</strong>' },
                              { text: headers[0].H10, value: '&nbsp;<strong>$$H10$$</strong>' },
                              { text: headers[0].H11, value: '&nbsp;<strong>$$H11$$</strong>' },
                              { text: headers[0].H12, value: '&nbsp;<strong>$$H12$$</strong>' },
                              { text: headers[0].H13, value: '&nbsp;<strong>$$H13$$</strong>' },
                              { text: headers[0].H14, value: '&nbsp;<strong>$$H14$$</strong>' },
                              { text: headers[0].H15, value: '&nbsp;<strong>$$H15$$</strong>' },
                              { text: headers[0].H16, value: '&nbsp;<strong>$$H16$$</strong>' },
                              { text: headers[0].H17, value: '&nbsp;<strong>$$H17$$</strong>' },
                              { text: headers[0].H18, value: '&nbsp;<strong>$$H18$$</strong>' },
                              { text: headers[0].H19, value: '&nbsp;<strong>$$H19$$</strong>' },
                              { text: headers[0].H20, value: '&nbsp;<strong>$$H20$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H19 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect |  mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' },
                              { text: headers[0].H7, value: '&nbsp;<strong>$$H7$$</strong>' },
                              { text: headers[0].H8, value: '&nbsp;<strong>$$H8$$</strong>' },
                              { text: headers[0].H9, value: '&nbsp;<strong>$$H9$$</strong>' },
                              { text: headers[0].H10, value: '&nbsp;<strong>$$H10$$</strong>' },
                              { text: headers[0].H11, value: '&nbsp;<strong>$$H11$$</strong>' },
                              { text: headers[0].H12, value: '&nbsp;<strong>$$H12$$</strong>' },
                              { text: headers[0].H13, value: '&nbsp;<strong>$$H13$$</strong>' },
                              { text: headers[0].H14, value: '&nbsp;<strong>$$H14$$</strong>' },
                              { text: headers[0].H15, value: '&nbsp;<strong>$$H15$$</strong>' },
                              { text: headers[0].H16, value: '&nbsp;<strong>$$H16$$</strong>' },
                              { text: headers[0].H17, value: '&nbsp;<strong>$$H17$$</strong>' },
                              { text: headers[0].H18, value: '&nbsp;<strong>$$H18$$</strong>' },
                              { text: headers[0].H19, value: '&nbsp;<strong>$$H19$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H18 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect |mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' },
                              { text: headers[0].H7, value: '&nbsp;<strong>$$H7$$</strong>' },
                              { text: headers[0].H8, value: '&nbsp;<strong>$$H8$$</strong>' },
                              { text: headers[0].H9, value: '&nbsp;<strong>$$H9$$</strong>' },
                              { text: headers[0].H10, value: '&nbsp;<strong>$$H10$$</strong>' },
                              { text: headers[0].H11, value: '&nbsp;<strong>$$H11$$</strong>' },
                              { text: headers[0].H12, value: '&nbsp;<strong>$$H12$$</strong>' },
                              { text: headers[0].H13, value: '&nbsp;<strong>$$H13$$</strong>' },
                              { text: headers[0].H14, value: '&nbsp;<strong>$$H14$$</strong>' },
                              { text: headers[0].H15, value: '&nbsp;<strong>$$H15$$</strong>' },
                              { text: headers[0].H16, value: '&nbsp;<strong>$$H16$$</strong>' },
                              { text: headers[0].H17, value: '&nbsp;<strong>$$H17$$</strong>' },
                              { text: headers[0].H18, value: '&nbsp;<strong>$$H18$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H17 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' },
                              { text: headers[0].H7, value: '&nbsp;<strong>$$H7$$</strong>' },
                              { text: headers[0].H8, value: '&nbsp;<strong>$$H8$$</strong>' },
                              { text: headers[0].H9, value: '&nbsp;<strong>$$H9$$</strong>' },
                              { text: headers[0].H10, value: '&nbsp;<strong>$$H10$$</strong>' },
                              { text: headers[0].H11, value: '&nbsp;<strong>$$H11$$</strong>' },
                              { text: headers[0].H12, value: '&nbsp;<strong>$$H12$$</strong>' },
                              { text: headers[0].H13, value: '&nbsp;<strong>$$H13$$</strong>' },
                              { text: headers[0].H14, value: '&nbsp;<strong>$$H14$$</strong>' },
                              { text: headers[0].H15, value: '&nbsp;<strong>$$H15$$</strong>' },
                              { text: headers[0].H16, value: '&nbsp;<strong>$$H16$$</strong>' },
                              { text: headers[0].H17, value: '&nbsp;<strong>$$H17$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H16 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' },
                              { text: headers[0].H7, value: '&nbsp;<strong>$$H7$$</strong>' },
                              { text: headers[0].H8, value: '&nbsp;<strong>$$H8$$</strong>' },
                              { text: headers[0].H9, value: '&nbsp;<strong>$$H9$$</strong>' },
                              { text: headers[0].H10, value: '&nbsp;<strong>$$H10$$</strong>' },
                              { text: headers[0].H11, value: '&nbsp;<strong>$$H11$$</strong>' },
                              { text: headers[0].H12, value: '&nbsp;<strong>$$H12$$</strong>' },
                              { text: headers[0].H13, value: '&nbsp;<strong>$$H13$$</strong>' },
                              { text: headers[0].H14, value: '&nbsp;<strong>$$H14$$</strong>' },
                              { text: headers[0].H15, value: '&nbsp;<strong>$$H15$$</strong>' },
                              { text: headers[0].H16, value: '&nbsp;<strong>$$H16$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H15 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' },
                              { text: headers[0].H7, value: '&nbsp;<strong>$$H7$$</strong>' },
                              { text: headers[0].H8, value: '&nbsp;<strong>$$H8$$</strong>' },
                              { text: headers[0].H9, value: '&nbsp;<strong>$$H9$$</strong>' },
                              { text: headers[0].H10, value: '&nbsp;<strong>$$H10$$</strong>' },
                              { text: headers[0].H11, value: '&nbsp;<strong>$$H11$$</strong>' },
                              { text: headers[0].H12, value: '&nbsp;<strong>$$H12$$</strong>' },
                              { text: headers[0].H13, value: '&nbsp;<strong>$$H13$$</strong>' },
                              { text: headers[0].H14, value: '&nbsp;<strong>$$H14$$</strong>' },
                              { text: headers[0].H15, value: '&nbsp;<strong>$$H15$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H14 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' },
                              { text: headers[0].H7, value: '&nbsp;<strong>$$H7$$</strong>' },
                              { text: headers[0].H8, value: '&nbsp;<strong>$$H8$$</strong>' },
                              { text: headers[0].H9, value: '&nbsp;<strong>$$H9$$</strong>' },
                              { text: headers[0].H10, value: '&nbsp;<strong>$$H10$$</strong>' },
                              { text: headers[0].H11, value: '&nbsp;<strong>$$H11$$</strong>' },
                              { text: headers[0].H12, value: '&nbsp;<strong>$$H12$$</strong>' },
                              { text: headers[0].H13, value: '&nbsp;<strong>$$H13$$</strong>' },
                              { text: headers[0].H14, value: '&nbsp;<strong>$$H14$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H13 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' },
                              { text: headers[0].H7, value: '&nbsp;<strong>$$H7$$</strong>' },
                              { text: headers[0].H8, value: '&nbsp;<strong>$$H8$$</strong>' },
                              { text: headers[0].H9, value: '&nbsp;<strong>$$H9$$</strong>' },
                              { text: headers[0].H10, value: '&nbsp;<strong>$$H10$$</strong>' },
                              { text: headers[0].H11, value: '&nbsp;<strong>$$H11$$</strong>' },
                              { text: headers[0].H12, value: '&nbsp;<strong>$$H12$$</strong>' },
                              { text: headers[0].H13, value: '&nbsp;<strong>$$H13$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H12 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' },
                              { text: headers[0].H7, value: '&nbsp;<strong>$$H7$$</strong>' },
                              { text: headers[0].H8, value: '&nbsp;<strong>$$H8$$</strong>' },
                              { text: headers[0].H9, value: '&nbsp;<strong>$$H9$$</strong>' },
                              { text: headers[0].H10, value: '&nbsp;<strong>$$H10$$</strong>' },
                              { text: headers[0].H11, value: '&nbsp;<strong>$$H11$$</strong>' },
                              { text: headers[0].H12, value: '&nbsp;<strong>$$H12$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H11 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' },
                              { text: headers[0].H7, value: '&nbsp;<strong>$$H7$$</strong>' },
                              { text: headers[0].H8, value: '&nbsp;<strong>$$H8$$</strong>' },
                              { text: headers[0].H9, value: '&nbsp;<strong>$$H9$$</strong>' },
                              { text: headers[0].H10, value: '&nbsp;<strong>$$H10$$</strong>' },
                              { text: headers[0].H11, value: '&nbsp;<strong>$$H11$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H10 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' },
                              { text: headers[0].H7, value: '&nbsp;<strong>$$H7$$</strong>' },
                              { text: headers[0].H8, value: '&nbsp;<strong>$$H8$$</strong>' },
                              { text: headers[0].H9, value: '&nbsp;<strong>$$H9$$</strong>' },
                              { text: headers[0].H10, value: '&nbsp;<strong>$$H10$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H9 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' },
                              { text: headers[0].H7, value: '&nbsp;<strong>$$H7$$</strong>' },
                              { text: headers[0].H8, value: '&nbsp;<strong>$$H8$$</strong>' },
                              { text: headers[0].H9, value: '&nbsp;<strong>$$H9$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H8 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' },
                              { text: headers[0].H7, value: '&nbsp;<strong>$$H7$$</strong>' },
                              { text: headers[0].H8, value: '&nbsp;<strong>$$H8$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H7 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' },
                              { text: headers[0].H7, value: '&nbsp;<strong>$$H7$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H6 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' },
                              { text: headers[0].H6, value: '&nbsp;<strong>$$H6$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H5 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' },
                              { text: headers[0].H5, value: '&nbsp;<strong>$$H5$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H4 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' },
                              { text: headers[0].H4, value: '&nbsp;<strong>$$H4$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H3 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' },
                              { text: headers[0].H3, value: '&nbsp;<strong>$$H3$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H2 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' },
                              { text: headers[0].H2, value: '&nbsp;<strong>$$H2$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }else if(headers[0].H1 != ""){
                    tinymce.init({
                        selector: 'textarea',
                        theme: 'modern',
                        plugins: 'print preview fullpage paste searchreplace autoresize autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker autosave save searchreplace imagetools image code media link contextmenu colorpicker textpattern visualblocks help',
                        toolbar1: 'bold italic strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent  | removeformat | undo redo | image code',
                        toolbar2: 'formatselect | fontselect | mybutton',
                        image_advtab: true,
                        autoresize_min_height: 350,
                        autoresize_overflow_padding: 20,
                        autoresize_bottom_margin: 20,
                        templates: [
                          { title: 'Test template 1', content: 'Test 1' },
                          { title: 'Test template 2', content: 'Test 2' }
                        ],
                        relative_urls : false,
                        remove_script_host : false,
                        convert_urls : true,
                        images_upload_url: '@Url.Action("TinyMceUpload", "TinyMce")',
                        setup: function (editor) {
                          editor.addButton('mybutton', {
                            type: 'listbox',
                            text: 'Manage Tags',
                            icon: false,
                            onselect: function (e) {
                              editor.insertContent(this.value());
                            },
                            values: [
                              { text: headers[0].H1, value: '&nbsp;<strong>$$H1$$</strong>' }
                            ],
                            onPostRender: function () {
                              // Select the second item by default
                              this.value('&nbsp;<em>Some italic text!</em>');
                            }
                          });
                        },
                        content_css: [
                        ]
                    });
                }
            }, 2000
        );
    });

    $(document).on('change', '#listID1', function(){
        var tag = $(this).val();
        $("#Recipient").val($('#Recipient').val() + tag);
    });

    $(document).on('change', '#listID2', function(){
        var tag = $(this).val();
        $("#cc").val($('#cc').val() + tag);
    });

    $(document).on('change', '#listID3', function(){
        var tag = $(this).val();
        $("#bcc").val($('#bcc').val() + tag);
    });

    $(document).on('change', '#listID4', function(){
        var tag = $(this).val();
        var tagText = $(this).find(':selected').text();
        $("#EmailTitle").val($('#EmailTitle').val() + tag);
        //$("#summernote").val($('#summernote').val() + tag);
    });

    $('#EmailTitle').on('change', function(){
        
        console.log($("#EmailTitle").val());
    });

    function readURL(input) {
        var iUpload = document.getElementById("Attachment");
        var regex = new RegExp("([a-zA-Z0-9\s_\\.\-:])+(.jpg|.png|.gif|.pdf|.doc|.docx|.xls|.xlsx|.txt)$");
        if (regex.test(iUpload.value.toLowerCase())){
		    if (input.files && input.files[0]) {
			    var reader = new FileReader();
                var fsize = iUpload.files[0].size;
                var conVertSize = Math.round((fsize / 1024));
                if(conVertSize > "15000"){
                    alert("Document size exceeds 15mb.");
                    $("#Attachment").val("");
                    $("#Attachment").empty();
                    return false;
                }else{
                    reader.onload = function (e) {
				        $('#falseinput').attr('src', e.target.result);
			        };
                }
		    }
        }
        else {
            alert("Please select a valid file in .jpg|.png|.gif|.pdf|.doc|.docx|.xls|.xlsx|.txt format");
            $("#Attachment").val("");
            return false;
        }
	}

    if( $('.mceu_56-text').is(':empty') ) {
        console.log('empty');
    }

</script>
